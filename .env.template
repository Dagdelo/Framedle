# Framedle Application Environment Variables
# Copy to .env and fill in real values:
#   cp .env.template .env
#
# Used by: docker-compose, Nuxt 3, Hono API, pipeline scripts
# This file is tracked in git — it contains NO secrets, only structure.

# ============================================================
# Application
# ============================================================
NODE_ENV=production
DOMAIN=framedle.wtf
APP_URL=https://framedle.wtf
API_URL=https://api.framedle.wtf
NUXT_PUBLIC_API_URL=https://api.framedle.wtf
ADMIN_SECRET=CHANGE_ME

# ============================================================
# Database (PostgreSQL)
# ============================================================
POSTGRES_USER=framedle
POSTGRES_PASSWORD=CHANGE_ME
POSTGRES_DB=framedle
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}

# Additional databases (shared PostgreSQL instance)
LOGTO_DB_URL=postgresql://logto:CHANGE_ME@postgres:5432/logto
UMAMI_DB_URL=postgresql://umami:CHANGE_ME@postgres:5432/umami
GLITCHTIP_DB_URL=postgresql://glitchtip:CHANGE_ME@postgres:5432/glitchtip

# ============================================================
# Redis / Valkey
# ============================================================
REDIS_URL=redis://valkey:6379

# ============================================================
# Object Storage (R2 or Garage)
# ============================================================
R2_ENDPOINT=https://YOUR_ACCOUNT_ID.r2.cloudflarestorage.com
R2_ACCESS_KEY=CHANGE_ME
R2_SECRET_KEY=CHANGE_ME
R2_BUCKET=framedle-content

# ============================================================
# Auth — Logto (self-hosted)
# ============================================================
# Shared: base Logto instance URL (used by API and Nuxt)
LOGTO_ENDPOINT=https://auth.framedle.wtf
LOGTO_ADMIN_ENDPOINT=https://logto-admin.hd5.dev

# Nuxt web app OIDC client (Traditional Web Application in Logto)
NUXT_LOGTO_APP_ID=CHANGE_ME
NUXT_LOGTO_APP_SECRET=CHANGE_ME
NUXT_LOGTO_ENDPOINT=https://auth.framedle.wtf
# API resource identifier registered in Logto — used as token audience (web→API calls)
NUXT_LOGTO_API_RESOURCE=https://api.framedle.wtf
# Secret for encrypting the H3 session cookie — generate with: openssl rand -base64 32
NUXT_LOGTO_COOKIE_SECRET=CHANGE_ME

# Hono API JWT verification
# Must match the API resource registered in Logto
LOGTO_API_RESOURCE=https://api.framedle.wtf

# Logto webhook signature verification (set in Logto Console → Webhooks)
LOGTO_WEBHOOK_SECRET=CHANGE_ME

# Machine-to-machine app for Logto Management API (user invites, role management)
# Create in Logto Console → Applications → Machine-to-machine
LOGTO_M2M_APP_ID=CHANGE_ME
LOGTO_M2M_APP_SECRET=CHANGE_ME
# Logto Management API resource — hardcoded in Logto OSS, do not change
LOGTO_MANAGEMENT_API_RESOURCE=https://default.logto.app/api

# Legacy vars (kept for backward compat — migrate to NUXT_ prefix above)
LOGTO_APP_ID=CHANGE_ME
LOGTO_APP_SECRET=CHANGE_ME

# Auth — Clerk (managed, alternative to Logto)
# NUXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_CHANGE_ME
# CLERK_SECRET_KEY=sk_test_CHANGE_ME

# ============================================================
# Analytics — Umami (self-hosted)
# ============================================================
NUXT_PUBLIC_UMAMI_WEBSITE_ID=CHANGE_ME
NUXT_PUBLIC_UMAMI_URL=https://analytics.framedle.wtf

# ============================================================
# Error Tracking — GlitchTip (self-hosted, Sentry-compatible)
# ============================================================
NUXT_PUBLIC_SENTRY_DSN=https://KEY@errors.framedle.wtf/1
GLITCHTIP_SECRET_KEY=CHANGE_ME

# ============================================================
# Content Pipeline
# ============================================================
# Used by GitHub Actions workflow and local pipeline scripts
# PIPELINE_DB_URL uses the external VPS URL (not Docker internal)
PIPELINE_DB_URL=postgresql://framedle:CHANGE_ME@YOUR_HOST:5432/framedle
